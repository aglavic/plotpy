# completions for plot.py


_plotpy() {
  if [ ! "$PLOTPY_TYPES" ] 
    then 
      # just execute the program once to get the known sessions and file types
      export PLOTPY_TYPES=`devplot --types`
  fi
  
  local curw flist item
  COMPREPLY=()
  curw="${COMP_WORDS[$COMP_CWORD]}"
  if [ $COMP_CWORD == 1 ]
    then 
      if [ ! "$PLOTPY_SESSIONS" ] 
        then 
          # just execute the program once to get the known sessions and file types
          export PLOTPY_SESSIONS=`devplot --sessions`
      fi
      COMPREPLY=($(compgen -W "$PLOTPY_SESSIONS" -- $curw))
    else
      flist=$(for item in $PLOTPY_TYPES; do compgen -G "$item"; done)
      #`ls $PLOTPY_TYPES 2>/dev/null` 
#      for item in $PLOTPY_TYPES
#        do
#         COMPREPLY=(${COMPREPLY[@]} $(compgen -G "$curw$item"))
#      done
#     #  $(compgen -G "$curw*.d_dat.gz") $(compgen -S/ -d -- $curw));;
    COMPREPLY=($(compgen -W "$flist" -- $curw)  $(compgen -S/ -d -- $curw))
  fi
  return 0
  }

complete -F _plotpy -o nospace plotpy

